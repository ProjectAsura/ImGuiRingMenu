//-----------------------------------------------------------------------------
// File : ImGuiRingMenu.h
// Desc : ImGui Ring Menu.
// Copyright(c) Project Asura. All right reserved.
//-----------------------------------------------------------------------------
#pragma once

//-----------------------------------------------------------------------------
// Includes
//-----------------------------------------------------------------------------
#include <cstdint>
#include <string>
#include <vector>


#ifndef ImTextureID
typedef uint64_t ImTextureID;
#endif//ImTextureID


///////////////////////////////////////////////////////////////////////////////
// ImGuiRingMenu class
///////////////////////////////////////////////////////////////////////////////
class ImGuiRingMenu
{
    //=========================================================================
    // list of friend classes and methods.
    //=========================================================================
    /* NOTHING */

public:
    ///////////////////////////////////////////////////////////////////////////
    // MenuItem structure
    ///////////////////////////////////////////////////////////////////////////
    struct MenuItem
    {
        ImTextureID     Icon;   //!< メニューアイコン.
        std::string     Label;  //!< 表示文字列.
    };

    ///////////////////////////////////////////////////////////////////////////
    // Config structure
    ///////////////////////////////////////////////////////////////////////////
    struct Config
    {
        int         KeyMenuStart        = 524;                  //!< メニュー開始キー.
        int         KeyMenuEnd          = 526;                  //!< メニュー終了キー.
        int         KeyConfirmation     = 525;                  //!< 決定キー.
        int         KeyCwRotate         = 514;                  //!< 時計回り回転キー.
        int         KeyCcwRotate        = 513;                  //!< 反時計周り回転キー.
        float       AnimSpeed           = 6.0f;                 //!< アニメーションスピード.
        float       IconSize            = 64.0f;                //!< アイコンサイズ.
    };

    //=========================================================================
    // public variables.
    //=========================================================================
    /* NOTHING */

    //=========================================================================
    // public methods.
    //=========================================================================

    //-------------------------------------------------------------------------
    //! @brief      コンストラクタです.
    //-------------------------------------------------------------------------
    ImGuiRingMenu();

    //-------------------------------------------------------------------------
    //! @brief      デストラクタです.
    //-------------------------------------------------------------------------
    ~ImGuiRingMenu();

    //-------------------------------------------------------------------------
    //! @brief      指定されたメニュー項目を追加します.
    //! 
    //! @param[in]      item        追加する項目.
    //-------------------------------------------------------------------------
    void Add(const MenuItem& item);

    //-------------------------------------------------------------------------
    //! @brief      指定されたメニュー項目を削除します.
    //! 
    //! @param[in]      index       削除する項目番号.
    //-------------------------------------------------------------------------
    void Remove(uint32_t index);

    //-------------------------------------------------------------------------
    //! @brief      メニュー項目を全削除します.
    //-------------------------------------------------------------------------
    void Clear();

    //-------------------------------------------------------------------------
    //! @brief      アニメーション更新を行います.
    //! 
    //! @param[in]      deltaSec        前フレームからの差分時間(秒単位).
    //-------------------------------------------------------------------------
    void Update(float deltaSec);

    //-------------------------------------------------------------------------
    //! @brief      描画処理を行います.
    //! 
    //! @param[in,out]  selectedIndex   選択されているメニュー番号.
    //! @return     メニューが選択された true を返却します.
    //-------------------------------------------------------------------------
    bool Draw(int& selectedIndex);

    //-------------------------------------------------------------------------
    //! @brief      コンフィグを設定します.
    //! 
    //! @param[in]      value       設定する値.
    //-------------------------------------------------------------------------
    void SetConfig(const Config& value);

    //-------------------------------------------------------------------------
    //! @brief      コンフィグを取得します.
    //! 
    //! @return     コンフィグを返却します.
    //-------------------------------------------------------------------------
    const Config& GetConfig() const;


private:
    //=========================================================================
    // private variables.
    //=========================================================================
    std::vector<MenuItem>   m_Items;                    //!< メニューアイテムリスト.
    int                     m_SelectedId    = 0;        //!< 選択されている番号.
    float                   m_CurrentAngle  = 0.0f;     //!< 現在の回転角.
    float                   m_TargetAngle   = 0.0f;     //!< 目標とする回転角.
    float                   m_AnimProgress  = 0.0f;     //!< アニメーション進捗率[0, 1].
    float                   m_AnimSpeed     = 8.0f;     //!< アニメーションスピード.
    uint8_t                 m_State         = 0;        //!< アニメーションステート.
    Config                  m_Config        = {};       //!< コンフィグ.

    //=========================================================================
    // private methods.
    //=========================================================================
    /* NOTHING */
};
